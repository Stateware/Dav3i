/*! Dav3i - v0.1.0 - 2015-08-27
* https://github.com/Stateware/Dav3i
* Copyright (c) 2015 Stateware Team;
 Licensed GPL v3 (https://github.com/Stateware/Dav3i/blob/master/LICENSE) */
function BuildList(a){var b;null==g_DataList&&(g_DataList=new c_List),g_DataList.clear();for(var c=0;c<a.length;c++)void 0!==g_Data[a[c]]&&void 0!==g_Data[a[c]][g_StatId]&&(b=new t_AsdsNode(a[c],g_Countries[a[c]],g_Data[a[c]]),g_DataList.add(b))}function t_AsdsNode(a,b,c){this.cc2=a,this.name=b,this.data=c,this.next=null}function c_List(){this.size=0,this.start=null,this.add=function(a){var b;b=this.start,this.start=a,this.start.next=b,this.size++},this.clear=function(){this.size=0,this.start=null}}function ParseData(){$.when(GetData()).done(function(a){SetInitalYears(a),g_Data=a.country_data,g_Stats=a.stats,g_Countries=a.countries,g_Diseases=a.diseases,g_StatId=Object.keys(g_Stats)[0],g_HmsYear=g_LastYear,ColorByHMS(),BuildTabs(),UpdateInputs(),SwitchToMain()})}function Hash(a){var b=26*(a.charCodeAt(0)-"A".charCodeAt(0))+(a.charCodeAt(1)-"A".charCodeAt(0));return b}function GetData(){return $.ajax({url:"API/get_data.php",dataType:"JSON",error:function(){console.log("Error receiving descriptor.php")},success:function(){console.log("Successfully received descriptor.php")}})}function SetInitalYears(a){g_FirstYear=Number(a.firstYear),g_YearStart=Number(a.firstYear),g_LastYear=Number(a.lastYear),g_YearEnd=Number(a.lastYear)}function GenerateLookupTable(a){var b,c,d=0;for(g_LookupTable=new Array(g_BUCKETS),g_NumCountries=a.cc2.length,c=0;c<a.cc2.length;c++)b=Hash(a.cc2[d]),g_LookupTable[b]=new Array(5),g_LookupTable[b][0]=d,g_LookupTable[b][1]=a.cc2[d],g_LookupTable[b][2]=a.common_name[d],g_LookupTable[b][3]=null,g_LookupTable[b][4]=0,d++}function GenerateStatReferenceList(a){var b;for(g_StatList=new Array(a.stats.length),b=0;b<a.stats.length;b++)g_StatList[b]=a.stats[b]}function SetTableData(){var a;for(a=0;a<g_LookupTable.length;a++)SetData(a)}function SetData(a){var b;void 0!==g_LookupTable[a]&&$.when(GetData(g_LookupTable[a][0])).done(function(c){b=ParseData(c),g_LookupTable[a][3]=b,g_DataLoaded++,g_DataLoaded===g_NumCountries&&(g_DataReady=!0)})}function SetHMS(a){var b;for(b=0;b<g_LookupTable.length;b++)void 0!==g_LookupTable[b]&&(g_LookupTable[b][4]=Number(a[g_LookupTable[b][0]]))}function GetHMS(a,b){return $.ajax({url:"API/by_stat.php?statID=".concat(a.toString()+"&year="+b.toString()),dataType:"JSON",success:function(b){console.log("Successfully received by_stat.php?statID=".concat(a.toString()))}})}function GetCID(a){var b=Hash(a),c=g_LookupTable[b][0];return c}function SelectIndex(a){g_SelectedIndex=Number(a.value)}function ParseStatList(){var a,b,c,d,e,f=g_StatList.slice(),g=[],h=0,i=0,j=1,k=2,l=3,m=-1,n=-1,o=-1;for(g[0]=[],g[1]=[],g[2]=[],g[3]=[],f.sort(),a=0;a<f.length;a++)c=f[a],d=!1,e=!1,c.indexOf("VACCL")>=0&&(d=!0,-1===m?m=g_StatList.indexOf(c):-1===n&&(n=g_StatList.indexOf(c))),a>0&&0===c.indexOf(f[a-1])?(d=!0,g[k][h-1]=g_StatList.indexOf(c)):a>1&&0===c.indexOf(f[a-2])&&(d=!0,g[l][h-1]=g_StatList.indexOf(c)),d||(g[j][h]=g_StatList.indexOf(c),c.indexOf("VACCB")<0?g[i][h]=0:(g[i][h]=1,isSIAInList=!0,o=h),h++);for(g[k][o]=m,g[l][o]=n,a=0;h>a;a++)for(b=0;4>b;b++)null===g[b][a]&&(g[b][a]=-1);g_ParsedStatList=g,console.log(g_ParsedStatList)}function SetGraphType(a){g_GraphType=a}function SetIntHms(a){g_IntHms=a}function ApplyAndClose(){ApplySettings()&&CloseSettings()}function CancelSettings(){var a=document.getElementById("year-range-start"),b=document.getElementById("year-range-end"),c=document.getElementById("heatmap-year");a.style["box-shadow"]="none",b.style["box-shadow"]="none",c.style["box-shadow"]="none",document.getElementById(a.id+"-error").innerHTML="",document.getElementById(b.id+"-error").innerHTML="",document.getElementById(c.id+"-error").innerHTML="",ResetAllStatValues(),CloseSettings()}function ResetAllStatValues(){var a=document.getElementById("year-range-start"),b=document.getElementById("year-range-end"),c=document.getElementById("heatmap-year");switch(a.value=g_TempSettings[0],b.value=g_TempSettings[1],c.value=g_TempSettings[2],g_TempSettings[3]){case 0:document.getElementById("graph-regional").checked=!0;break;case 1:document.getElementById("graph-combined").checked=!0;break;case 2:document.getElementById("graph-whole").checked=!0}switch(g_TempSettings[4]){case 0:document.getElementById("int0").checked=!0;break;case 1:document.getElementById("int1").checked=!0;break;case 2:document.getElementById("int2").checked=!0}g_YearStart=g_TempSettings[0],g_YearEnd=g_TempSettings[1],g_HmsYear=g_TempSettings[2],g_GraphType=g_TempSettings[3],g_IntHMS=g_TempSettings[4]}function SaveCurrentStatValues(){var a=document.getElementById("year-range-start"),b=document.getElementById("year-range-end"),c=document.getElementById("heatmap-year");g_TempSettings[0]=a.value,g_TempSettings[1]=b.value,g_TempSettings[2]=c.value,g_TempSettings[3]=g_GraphType,g_TempSettings[4]=g_IntHms}function ApplySettings(){var a=!0,b=document.getElementById("year-range-start"),c=document.getElementById("year-range-end"),d=document.getElementById("heatmap-year");return b.style["box-shadow"]="",c.style["box-shadow"]="",d.style["box-shadow"]="",document.getElementById(b.id+"-error").style.cursor="default",document.getElementById(c.id+"-error").style.cursor="default",document.getElementById(d.id+"-error").style.cursor="default",document.getElementById(b.id+"-error").innerHTML="&emsp;",document.getElementById(c.id+"-error").innerHTML="&emsp;",document.getElementById(d.id+"-error").innerHTML="&emsp;",document.getElementById(b.id+"-error").removeAttribute("tooltip"),document.getElementById(c.id+"-error").removeAttribute("tooltip"),document.getElementById(d.id+"-error").removeAttribute("tooltip"),document.getElementById(b.id+"-error").className="",document.getElementById(c.id+"-error").className="",document.getElementById(d.id+"-error").className="",(""===b.value||Number(b.value)<Number(b.min)||Number(b.value)>Number(b.max)||isNaN(b.value))&&(a=!1,b.style["box-shadow"]="0px 0px 8px #F00",document.getElementById(b.id+"-error").style.cursor="help",document.getElementById(b.id+"-error").innerHTML="X",document.getElementById(b.id+"-error").setAttribute("tooltip","Out of range: "+b.min+"-"+b.max),document.getElementById(b.id+"-error").className="settings-error"),(""===c.value||Number(c.value)<Number(c.min)||Number(c.value)>Number(c.max)||isNaN(c.value))&&(a=!1,c.style["box-shadow"]="0px 0px 8px #F00",document.getElementById(c.id+"-error").style.cursor="help",document.getElementById(c.id+"-error").innerHTML="X",document.getElementById(c.id+"-error").setAttribute("tooltip","Out of range: "+c.min+"-"+c.max),document.getElementById(c.id+"-error").className="settings-error"),(""===d.value||Number(d.value)<Number(d.min)||Number(d.value)>Number(d.max)||isNaN(d.value))&&(a=!1,d.style["box-shadow"]="0px 0px 8px #F00",document.getElementById(d.id+"-error").style.cursor="help",document.getElementById(d.id+"-error").innerHTML="X",document.getElementById(d.id+"-error").setAttribute("tooltip","Out of range: "+d.min+"-"+d.max),document.getElementById(d.id+"-error").className="settings-error"),c.value<b.value&&(a=!1,b.style["box-shadow"]="0px 0px 8px #F00",c.style["box-shadow"]="0px 0px 8px #F00",document.getElementById(b.id+"-error").style.cursor="help",document.getElementById(c.id+"-error").style.cursor="help",document.getElementById(b.id+"-error").innerHTML="X",document.getElementById(c.id+"-error").innerHTML="X",document.getElementById(b.id+"-error").setAttribute("tooltip","Year must be before End."),document.getElementById(c.id+"-error").setAttribute("tooltip","Year must be after Start."),document.getElementById(b.id+"-error").className="settings-error",document.getElementById(c.id+"-error").className="settings-error"),a?(b.style["box-shadow"]="0px 0px 8px #00FF00",c.style["box-shadow"]="0px 0px 8px #00FF00",d.style["box-shadow"]="0px 0px 8px #00FF00",document.getElementById(b.id+"-error").innerHTML="&#10003",document.getElementById(c.id+"-error").innerHTML="&#10003",document.getElementById(d.id+"-error").innerHTML="&#10003",g_YearStart=b.value,g_YearEnd=c.value,g_HmsYear=d.value,GenerateSubDivs(),GenerateGraphs(),ColorByHMS(),SaveCurrentStatValues(),!0):!1}function GenerateGraphs(){var a,b,c,d,e;if(void 0!==g_DataList&&0!==g_DataList.size)if(d=g_DataList.start,"int"!==g_Stats[g_StatId].type)switch(g_GraphType){case 0:for(b=FindMax(),e=1;e<=g_DataList.size;e++)-1===GraphRegional("region-graphs-"+e,d,b)&&(c=document.getElementById("region-graphs-"+e),c.parentNode.removeChild(c)),d=d.next;break;case 1:GraphCombined("region-graphs-1");break;case 2:a=GenerateSumNode(),GraphRegional("region-graphs-1",a)}else switch(g_GraphType){case 0:for(b=FindMax(),e=1;e<=g_DataList.size;e++)-1===GraphIntegrated("region-graphs-"+e,d,b)&&(c=document.getElementById("region-graphs-"+e),c.parentNode.removeChild(c)),d=d.next;break;case 1:for(e=1;e<=g_DataList.size;e++)-1===GraphIntegrated("region-graphs-"+e,d,b)&&(c=document.getElementById("region-graphs-"+e),c.parentNode.removeChild(c)),d=d.next;break;case 2:a=GenerateSumNode(),GraphIntegrated("region-graphs-1",a)}}function GraphRegional(a,b,c){var d,e,f,g=GenerateSingleData(b.data[g_StatId].data),h={title:b.name,seriesType:"line",legend:"none",vAxis:{viewWindowMode:"explicit",viewWindow:{min:0,max:c}},hAxis:{title:"Year",format:"####"},series:{0:{color:"white"},1:{type:"area",color:"transparent"},2:{color:"navy"},3:{type:"area",color:"navy"}},isStacked:!0,backgroundColor:"#EAE7C2",tooltip:{trigger:"both"}};if("est"!==g_Stats[g_StatId].type&&(h.series[0].color="navy"),null!==g){for(d=new google.visualization.NumberFormat({pattern:"#,###.##"}),f=1;f<g.getNumberOfColumns();f++)null!==g&&d.format(g,f);return e=new google.visualization.ComboChart(document.getElementById(a)),e.draw(g,h),0}return-1}function GraphCombined(a){var b,c,d,e,f=GenerateCombinedData(),g={seriesType:"line",legend:{position:"top"},vAxis:{viewWindowMode:"explicit",viewWindow:{min:0}},hAxis:{title:"Year",format:"####"},backgroundColor:"#EAE7C2",tooltip:{trigger:"both"}};for(b=[],c=new google.visualization.NumberFormat({pattern:"#,###.##"}),e=1;e<f.getNumberOfColumns();e++)c.format(f,e);d=new google.visualization.LineChart(document.getElementById(a)),d.draw(f,g)}function GraphIntegrated(a,b,c){var d,e,f,g=GenerateSingleData(b.data[g_StatId].data),h={0:{type:"bar"},1:{type:"bar"},2:{type:"bar"}},i={title:b.name,vAxis:{viewWindowMode:"explicit",viewWindow:{min:0,max:1},format:"###%"},hAxis:{title:"Year",format:"####"},backgroundColor:"#EAE7C2",seriesType:"bars",tooltip:{trigger:"both"}};for(c>1&&(i.vAxis.viewWindow.max=c),f=0;f<g_Stats[g_StatId].subType.length;f++)"lin"===g_Stats[g_StatId].subType[f]&&(h[f].type="line");for(i.series=h,d=new google.visualization.NumberFormat({pattern:"##.##%"}),f=1;f<g.getNumberOfColumns();f++)d.format(g,f);e=new google.visualization.ComboChart(document.getElementById(a)),e.draw(g,i)}function FixMissingData(a){return-1!=a?a:null}function GetYears(a){var b=[],c=new RegExp("y_(\\d+)");for(i in a)"country_id"!==i&&"data_set_index"!==i&&(year=c.exec(i),b.push(Number(year[1])));return b}function GetValues(a){var b=[];for(i in a)"country_id"!==i&&"data_set_index"!==i&&b.push(FixMissingData(Number(a[i])));return b}function GenerateSingleData(a){var b,c=new google.visualization.DataTable,d=new Array(4);if("est"===g_Stats[g_StatId].type)for(d[0]=GetYears(a[g_SelectedIndex].values[0]),d[1]=GetValues(a[g_SelectedIndex].values[0]),d[2]=GetValues(a[g_SelectedIndex].values[1]),d[3]=GetValues(a[g_SelectedIndex].values[2]),c.addColumn("number","year"),c.addColumn("number",g_Stats[g_StatId].subName[1]),c.addColumn("number","lower bound space"),c.addColumn("number",g_Stats[g_StatId].subName[2]),c.addColumn("number","size of confidence interval"),c.addColumn("number",g_Stats[g_StatId].subName[0]),b=0;b<d[0].length;b++)c.addRow([d[0][b],d[2][b],d[3][b],d[3][b],d[1][b]-d[3][b],d[1][b]]);else if("int"===g_Stats[g_StatId].type)for(d[0]=GetYears(a[g_SelectedIndex].values[0].values),d[1]=GetValues(a[g_SelectedIndex].values[0].values),d[2]=GetValues(a[g_SelectedIndex].values[1].values),d[3]=GetValues(a[g_SelectedIndex].values[2].values),c.addColumn("number","year"),c.addColumn("number",g_Stats[g_StatId].subName[0]),c.addColumn("number",g_Stats[g_StatId].subName[1]),c.addColumn("number",g_Stats[g_StatId].subName[2]),b=0;b<d[0].length;b++)c.addRow([d[0][b],d[1][b],d[2][b],d[3][b]]);else for(c.addColumn("number","year"),c.addColumn("number",g_Stats[g_StatId].name),d[0]=GetYears(a[g_SelectedIndex].values),d[1]=GetValues(a[g_SelectedIndex].values),b=0;b<d[0].length;b++)c.addRow([d[0][b],d[1][b]]);return c}function GenerateCombinedData(){var a,b,c,d,e=new google.visualization.DataTable,f=new Array(g_DataList.size+1);for(e.addColumn("number","year"),c=g_DataList.start,a=0;a<g_DataList.size;a++)e.addColumn("number",c.name),c=c.next;if(c=g_DataList.start,"est"===g_Stats[g_StatId].type)for(f[0]=GetYears(c.data[g_StatId].data[g_SelectedIndex].values[1]),a=0;a<g_DataList.size;a++)f[a+1]=GetValues(c.data[g_StatId].data[g_SelectedIndex].values[1]),c=c.next;else for(f[0]=GetYears(c.data[g_StatId].data[g_SelectedIndex].values),a=0;a<g_DataList.size;a++)f[a+1]=GetValues(c.data[g_StatId].data[g_SelectedIndex].values),c=c.next;for(a=0;a<f[0].length;a++){for(d=[],b=0;b<f.length;b++)d.push(f[b][a]);e.addRow(d)}return e}function GenerateSumNode(){var a,b,c,d,e,f="";for(c=g_DataList.start,a=jQuery.extend(!0,{},g_Data[c.cc2]),b=a[g_StatId].data,f+=c.name,c=c.next,d=1;d<g_DataList.size;d++){if(f+=", "+c.name,"est"===g_Stats[g_StatId].type)for(e=g_Data[c.cc2][g_StatId].firstYear;e<=g_Data[c.cc2][g_StatId].lastYear;e++)b[g_SelectedIndex].values[0]["y_"+e]=Number(b[g_SelectedIndex].values[0]["y_"+e]),-1!=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values[0]["y_"+e])&&(b[g_SelectedIndex].values[0]["y_"+e]+=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values[0]["y_"+e])),b[g_SelectedIndex].values[1]["y_"+e]=Number(b[g_SelectedIndex].values[1]["y_"+e]),-1!=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values[1]["y_"+e])&&(b[g_SelectedIndex].values[1]["y_"+e]+=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values[1]["y_"+e])),b[g_SelectedIndex].values[2]["y_"+e]=Number(b[g_SelectedIndex].values[2]["y_"+e]),-1!=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values[2]["y_"+e])&&(b[g_SelectedIndex].values[2]["y_"+e]+=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values[2]["y_"+e]));else if("int"===g_Stats[g_StatId].type)for(e=g_Data[c.cc2][g_StatId].firstYear;e<=g_Data[c.cc2][g_StatId].lastYear;e++)b[g_SelectedIndex].values[0].values["y_"+e]=Number(b[g_SelectedIndex].values[0].values["y_"+e]),-1!=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values[0].values["y_"+e])&&(b[g_SelectedIndex].values[0].values["y_"+e]+=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values[0].values["y_"+e])),b[g_SelectedIndex].values[1].values["y_"+e]=Number(b[g_SelectedIndex].values[1].values["y_"+e]),-1!=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values[1].values["y_"+e])&&(b[g_SelectedIndex].values[1].values["y_"+e]+=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values[1].values["y_"+e])),3===b[g_SelectedIndex].length&&(b[g_SelectedIndex].values[2].values["y_"+e]=Number(b[g_SelectedIndex].values[2].values["y_"+e]),-1!=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values[2]["y_"+e])&&(b[g_SelectedIndex].values[2].values["y_"+e]+=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values[2].values["y_"+e])));else for(e=g_Data[c.cc2][g_StatId].firstYear;e<=g_Data[c.cc2][g_StatId].lastYear;e++)b[g_SelectedIndex].values["y_"+e]=Number(b[g_SelectedIndex].values["y_"+e]),-1!=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values["y_"+e])&&(b[g_SelectedIndex].values["y_"+e]+=Number(g_Data[c.cc2][g_StatId].data[g_SelectedIndex].values["y_"+e]));c=c.next}if("int"===g_Stats[g_StatId].type)for(e=g_Data[g_DataList.start.cc2][g_StatId].firstYear;e<=g_Data[g_DataList.start.cc2][g_StatId].lastYear;e++)b[g_SelectedIndex].values[0].values["y_"+e]=b[g_SelectedIndex].values[0].values["y_"+e]/g_DataList.size,b[g_SelectedIndex].values[1].values["y_"+e]=b[g_SelectedIndex].values[0].values["y_"+e]/g_DataList.size,b[g_SelectedIndex].values[2].values["y_"+e]=b[g_SelectedIndex].values[0].values["y_"+e]/g_DataList.size;return sumNode=new t_AsdsNode("sum",f,a),sumNode}function GetMaxFromValueRow(a){var b,c=Number.MIN_VALUE,d=new RegExp("y_(\\d+)");for(i in a)"country_id"!==i&&"data_set_index"!==i&&(b=d.exec(i),year=Number(b[1]),year>=g_YearStart&&year<=g_YearEnd&&Number(a[i])>c&&(c=Number(a[i])));return c}function FindMax(){var a,b,c=Number.MIN_VALUE,d=g_DataList.start;for(a=0;a<g_DataList.size;a++)b="est"===g_Stats[g_StatId].type?Math.max.apply(Math,[GetMaxFromValueRow(d.data[g_StatId].data[g_SelectedIndex].values[0]),GetMaxFromValueRow(d.data[g_StatId].data[g_SelectedIndex].values[1]),GetMaxFromValueRow(d.data[g_StatId].data[g_SelectedIndex].values[2])]):"int"===g_Stats[g_StatId].type?Math.max.apply(Math,[GetMaxFromValueRow(d.data[g_StatId].data[g_SelectedIndex].values[0].values),GetMaxFromValueRow(d.data[g_StatId].data[g_SelectedIndex].values[1].values),GetMaxFromValueRow(d.data[g_StatId].data[g_SelectedIndex].values[2].values)]):GetMaxFromValueRow(d.data[g_StatId].data[g_SelectedIndex].values),b>c&&(c=b),d=d.next;return 0>c||void 0===c||c===Number.MIN_VALUE?-1:c}function BuildTabs(){var a,b,c;for(a in g_Stats)b=g_Stats[a].name,c=document.createElement("DIV"),c.id="id-"+a,c.setAttribute("stat",a),c.className="graph-tab",c.setAttribute("onclick","ChooseTab(this)"),c.innerHTML=b,document.getElementById("tabsDiv").appendChild(c),BuildDiv(a),a===g_StatId&&(document.getElementById("id-"+a+"-graphs").style.display="block",c.className="graph-tab selected-tab");b="Custom",c=document.createElement("DIV"),c.id="id-custom",c.setAttribute("stat","custom"),c.className="graph-tab",c.setAttribute("onclick","ChooseTab(this)"),c.innerHTML=b,document.getElementById("tabsDiv").appendChild(c),BuildDiv("custom")}function UpdateInputs(){var a=document.getElementById("year-range-start"),b=document.getElementById("year-range-end"),c=document.getElementById("heatmap-year");a.max=g_LastYear,a.min=g_FirstYear,b.max=g_LastYear,b.min=g_FirstYear,c.max=g_LastYear,c.min=g_FirstYear,g_TempSettings[0]=g_FirstYear,g_TempSettings[1]=g_LastYear,g_TempSettings[2]=g_LastYear,g_TempSettings[3]=0,g_TempSettings[4]=1}function BuildDiv(a){var b=document.createElement("DIV");b.id="id-"+a+"-graphs",b.style.display="none",b.style.top="18%",b.style.height="77%",b.className="graph",document.getElementById("graphs").appendChild(BuildDropDown(a)),document.getElementById("graphs").appendChild(b)}function BuildDropDown(a){var b=document.createElement("DIV"),c="";if(b.id="id-"+a+"-dropdown",b.style.display="none",b.style.top="8%",b.style.height="10%",b.className="graph","custom"===g_StatId){c+="<p class='open-sans'>Select Data Set</p><select name='stat1' onchange='SelectIndex(this)'>";for(i in g_Stats)c+="<option value='"+i+"'>"+i+" - "}else{c+="<p class='open-sans'>Select Data Set</p><select name='index' onchange='SelectIndex(this)'>";for(i in g_Stats[g_StatId].tags)c+="<option value='"+i+"'>"+i+" - ",c+=""===g_Stats[g_StatId].tags[i]?"untagged":g_Stats[g_StatId].tags[g_SelectedIndex],c+="</option></br>";c+="</select>"}return b.innerHTML=c,b}function ChooseTab(a){var b,c,d="";g_SelectedIndex=0,b="id-"+g_StatId+"-graphs",document.getElementById(b).innerHTML="",c=document.getElementById("id-"+g_StatId),c.className="graph-tab",a.className="graph-tab selected-tab",document.getElementById("id-"+g_StatId+"-graphs").style.display="none",document.getElementById("id-"+g_StatId+"-dropdown").style.display="none",document.getElementById(a.id+"-graphs").style.display="block",document.getElementById(a.id+"-dropdown").style.display="block",g_StatId=a.getAttribute("stat"),"custom"!==g_StatId&&ColorByHMS(),document.getElementById(a.id+"-graphs").innerHTML=d,GenerateSubDivs(),(0===g_GraphType||1===g_GraphType&&"int"===g_Stats[g_StatId].type)&&FixDivSize(),GenerateGraphs()}function RotateTabs(a){var b,c=document.getElementById("tabsDiv"),d=c.childNodes;a>0?(b=d[0],c.removeChild(b),c.appendChild(b)):(b=d[d.length-1],c.removeChild(b),c.insertBefore(b,d[0]))}function SwitchToMain(){$(".loading-screen").fadeOut(750)}function OpenSettings(){ResetAllStatValues(),$(".settings-screen, .settings-black").fadeIn(400)}function CloseSettings(){$(".settings-screen, .settings-black").fadeOut(400);var a=document.getElementById("year-range-start"),b=document.getElementById("year-range-end"),c=document.getElementById("heatmap-year");a.style["box-shadow"]="",b.style["box-shadow"]="",c.style["box-shadow"]="",document.getElementById(a.id+"-error").innerHTML="",document.getElementById(b.id+"-error").innerHTML="",document.getElementById(c.id+"-error").innerHTML=""}function OpenHelp(){$(".help-screen, .help-black").fadeIn(400)}function CloseHelp(){$(".help-screen, .help-black").fadeOut(400)}function Expand(){$(".control-panel").animate({width:"97.5%"},500),$("#expand").attr("onclick","Shrink()"),$("#expand").attr("src","res/arrow_left.png"),$("#scroll-left").fadeOut(400),$("#scroll-right").fadeOut(400),$(".expand-black").fadeIn(400),setTimeout(function(){void 0!==g_DataList&&0!==g_DataList.size&&(g_Expanded=!0,GenerateSubDivs(),1===g_GraphType&&"int"!==g_StatList[g_StatId].type||2===g_GraphType?(document.getElementById("region-graphs-1").style.width="100%",document.getElementById("region-graphs-1").style.height="100%"):FixDivSize(),GenerateGraphs())},500)}function Shrink(){$(".control-panel").animate({width:"25%"},500),$("#expand").attr("onclick","Expand()"),$("#expand").attr("src","res/arrow_right.png"),$("#scroll-left").fadeIn(400),$("#scroll-right").fadeIn(400),$(".expand-black").fadeOut(400),setTimeout(function(){g_Expanded=!1,GenerateSubDivs(),FixDivSize(),GenerateGraphs()},500)}function GenerateSubDivs(){var a,b,c,d;if(void 0!==g_DataList)if(a=g_DataList.size,b="id-"+g_StatId+"-graphs",c=document.getElementById(b).childNodes.length,d=document.getElementById(b).childNodes,1===g_GraphType&&"int"!==g_Stats[g_StatId].type||2===g_GraphType)0!==a&&CreateSubDiv("region-graphs-1",b),g_Expanded&&(document.getElementById("region-graphs-1").style.width="100%",document.getElementById("region-graphs-1").style.height="100%");else{for(;c>a;)$("#region-graphs-"+c).remove(),c--;for(;a>c;)CreateSubDiv("region-graphs-"+(c+1),b),c++}}function CreateSubDiv(a,b){var c,d=document.createElement("div");d.id=a,d.className="subgraph",c=document.getElementsByTagName("div"),document.getElementById(b).appendChild(d),g_Expanded&&(0===g_GraphType||"int"===g_Stats[g_StatId].type&&1===g_GraphType)&&$(d).click(function(){"100%"!==document.getElementById(a).style.width?(document.getElementById(d.id).style.width="100%",document.getElementById(d.id).style.height="100%"):(document.getElementById(d.id).style.width="50%",document.getElementById(d.id).style.height="50%"),GenerateGraphs()})}function FixDivSize(){var a;for(a=0;a<g_DataList.size;a++)g_Expanded?document.getElementById("region-graphs-"+(a+1)).style.width="50%":document.getElementById("region-graphs-"+(a+1)).style.width="100%",document.getElementById("region-graphs-"+(a+1)).style.height="50%"}function teamPopup(){window.alert("Stateware Team\nSpring 2015:\nWilliam Bittner, Joshua Crafts, Nicholas Denaro, Dylan Fetch, Paul Jang, Arun Kumar, Drew Lopreiato, Kyle Nicholson, Emma Roudabush, Berty Ruan, Vanajam Soni")}function bugPopup(){window.alert("If you would like to report a bug, please send an email to stateware@acm.psu.edu with the following details included in your message:\n1. Description of the bug\n2. Steps for reproducing the bug\n3. What browser and operating system you experienced the bug on\n4. Any additional relevant information.")}var g_BUCKETS=676,g_Data,g_Countries,g_Stats,g_SelectedIndex=0,g_Diseases,g_FirstYear,g_LastYear,g_YearStart,g_YearEnd,g_DataList,g_StatId,g_HmsYear,g_GraphType=0,g_Clear=!1,g_Expanded=!1,g_IntHms=0,g_TempSettings=new Array(5),g_Map;ColorByHMS=function(){var a,b,c,d,e,f,g,h={};d=Number.MAX_VALUE,e=Number.MIN_VALUE;for(f in g_Map.regions)if(void 0!==g_Data[f]){b=g_Data[f][g_StatId].data;for(g in b)b[g].index===g_SelectedIndex&&(a=b[g].values);"lin"===g_Data[f][g_StatId].type||"bar"===g_Data[f][g_StatId].type?"-1"!==a["y_"+g_HmsYear]&&(c=a["y_"+g_HmsYear],void 0!=c&&(h[f]=c)):"est"===g_Data[f][g_StatId].type?"-1"!==a[1]["y_"+g_HmsYear]&&(c=a[1]["y_"+g_HmsYear],void 0!=c&&(h[f]=c)):"-1"!==a[g_IntHms].values["y_"+g_HmsYear]&&(c=a[g_IntHms].values["y_"+g_HmsYear],void 0!=c&&(h[f]=c)),void 0!==h[f]&&(Number(h[f])<d&&(d=h[f]),Number(h[f])>e&&(e=h[f]))}g_Map.series.regions[0].params.min=d,g_Map.series.regions[0].params.max=e,g_Map.reset(),Object.keys(h).length>0&&g_Map.series.regions[0].setValues(h)};